<section class="section">
    <div class="container">
        <div class="box">
            <div class="container">
                <div class="has-text-centered" style="margin-bottom:2em;">
                    <img src="/assets/images/{{page.stub}}.png" alt="{{page.title}}"
                        style="max-width:300px; width:100%; margin:0 auto; display:block;">
                </div>
                <h1 class="title has-text-centered">{{page.title}}</h1>
                <h3 class="subtitle has-text-centered" style="margin-bottom:2em;">Help <strong><i class="scoutname"></i></strong> raise funds for {{site.scout_type}} {{ site.unit_type }} {{ site.unit_number }}!</h3>
            </div>
            <div id="popcornfundraiser" style="display:none;">
                <p style="font-size:0.9em; color:gray;margin-bottom:1em;"><em>(Scroll down farther for Coffee Ordering)</em></p>
                <p><strong>Craving popcorn?</strong> Click below to order from your Scout’s personalized page!</p>
                <a id="popcornlink" class="button is-warning is-medium" href="{{ site.popcorn_base_link }}"
                    target="_blank" style="margin:1em 0;">
                    <span class="icon"><i class="fas fa-boxes-stacked"></i></span>
                    <span>Order Popcorn</span>
                </a>
            </div>

            <div>
                <p><strong>Interested in coffee?</strong> Please follow these steps to make sure your Scout gets credit for your order:</p>
                <!-- Instruction images in order -->
                <div style="max-width:350px; margin:1.5em 0; text-align:left;">
                    <div style="margin-bottom:1em;">
                        <div style="margin-bottom:0.5em;"><strong>Step 1.</strong> Click on the product image to select your items—avoid using the 'Add to Cart' button at this stage.</div>
                        <img src="/assets/images/coffee-instruct1.png" alt="Instruction 1" style="max-width:300px; width:100%; display:block; margin:0 auto;">
                    </div>
                    <div style="margin-bottom:1em;">
                        <div style="margin-bottom:0.5em;"><strong>Step 2.</strong> Enter your Scout’s information for each item before clicking 'Add to Cart.'</div>
                        <img src="/assets/images/coffee-instruct2.png" alt="Instruction 2" style="max-width:300px; width:100%; display:block; margin:0 auto;">
                    </div>
                    <div style="margin-bottom:1em;">
                        <div style="margin-bottom:0.5em;"><strong>Step 3.</strong> At checkout, confirm that your Scout’s information appears with each item.</div>
                        <img src="/assets/images/coffee-instruct3.png" alt="Instruction 3" style="max-width:300px; width:100%; display:block; margin:0 auto;">
                    </div>
                </div>

                <p><strong>For your convenience,</strong> here is your Scout’s information to use for each item:</p>
                <div class="table-container" style="max-width: 300px; margin: 0;">
                    <table class="table is-striped">
                        <tbody>
                            <tr>
                                <th>District</th>
                                <td>{{ site.district }}</td>
                            </tr>
                            <tr>
                                <th>Unit Type</th>
                                <td>{{ site.unit_type }}</td>
                            </tr>
                            <tr>
                                <th>Unit Number</th>
                                <td>{{ site.unit_number }}</td>
                            </tr>
                            <tr>
                                <th>Scout Name</th>
                                <td><span class="scoutname" id="scoutname"></span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="margin:1em 0;">
                    <a class="button is-link is-medium" href="{{ site.coffee_link }}" target="_blank" style="margin:1em 0;">
                        <span class="icon"><i class="fas fa-mug-hot"></i></span>
                        <span>Order Coffee</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Move script to end of body for valid HTML -->
<script>
    function getQuery() {
        const params = new URLSearchParams(window.location.search);
        return {
            scout: params.get('scout') || '',
            popcorn: params.get('popcorn') || ''
        };
    }
    function render() {
        const query = getQuery();
        // Scout name
        document.querySelectorAll('.scoutname').forEach(function (el) { el.textContent = query.scout || ''; });
        // Popcorn
        if (query.popcorn && query.scout) {
            document.getElementById('popcornfundraiser').style.display = '';
            document.getElementById('popcornlink').href = "{{ site.popcorn_base_link }}" + query.popcorn;
        } else {
            document.getElementById('popcornfundraiser').style.display = 'none';
            document.getElementById('popcornlink').href = '{{ site.popcorn_base_link }}';
        }
        // Error if missing scout
        if (!query.scout) {
            document.getElementById('popcornfundraiser').style.display = 'none';
            // Optionally show error message
            document.getElementById('scoutname').parentElement.innerHTML = '<b>Error:</b> Missing scout name.';
        }
    }
    render();
</script>