---
layout: none
title: Make
---
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make Custom Fundraiser Link for {{ site.scout_type }} {{ site.unit_type }} {{ site.unit_number }}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <style>
        @media print {
            #flyerSection {
                display: block !important;
                visibility: visible !important;
                position: static !important;
            }

            .no-print,
            #printButtonSection,
            #socialSection,
            #linkForm,
            #generator {
                display: none !important;
            }
        }

        /* Sunburst callout styles */
        .sunburst {
            position: absolute;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: #fff;
            box-shadow: 0 0 24px 0 var(--burst-color), 0 0 0 8px #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #222;
            font-size: 1.2em;
            text-align: center;
            z-index: 2;
            border: 3px solid #fff;
        }

        .sunburst span {
            display: block;
            width: 90px;
            transform: rotate(var(--angle));
            font-size: 1.2em;
            font-family: Arial, sans-serif;
            font-weight: bold;
            margin: 0 auto;
            text-shadow: 2px 2px 12px var(--burst-color), 0 0 2px #fff, 0 0 8px #fff;
        }

        #flyerTitle {
            font-size: 2.5em !important;
            font-weight: 900 !important;
            margin-bottom: 0.2em !important;
        }

        #flyerImg {
            height: 110px !important;
            margin: 0 10px !important;
        }

        .flyer-qr-area {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 2px 16px #ccc;
            padding: 32px;
            z-index: 3;
        }
    </style>
</head>

<body>
    <section class="section">
        <div class="container">
            <section id="generator">
                <div class="box">
                    <div class="has-text-centered" style="margin-bottom:1em;">
                        <span
                            style="font-size:2em; font-weight:bold; color:#3273dc; letter-spacing:2px; text-shadow: 1px 1px 2px #eee;">
                            {{ site.scout_type }} {{ site.unit_type }} {{ site.unit_number }}
                        </span>
                    </div>
                      <div class="has-text-centered" style="margin-bottom:1em; color:#888; font-size:0.9em;">
                        Revision: <span style="font-family:monospace;">{{ site.github.build_revision}}</span>
                        </div>
                    <h1 class="title is-3 has-text-centered">Create Your Personalized Coffee Fundraiser Link & Flyer</h1>
                    <h2 class="subtitle is-5 has-text-centered">For Online Sales</h2>
                    <form id="linkForm">
                        <div class="field">
                            <label class="label" for="scout">Enter Your Scout's Name<span
                                    class="has-text-danger">(required)</span>:</label>
                            <div class="control">
                                <input class="input" type="text" id="scout" name="scout" required>
                            </div>
                        </div>
                        <div class="field">
                            <label class="label" for="popcorn">Popcorn Scout Code <span
                                    class="has-text-grey">(optional)</span>:</label>
                            <p class="help">Find your Scout Code in the Trail's End app under "Share My Page". Adding it here will include popcorn sales in your fundraiser link.</p>
                            <div class="control" style="display:flex; align-items:center; gap:0.5em;">
                                <input class="input" type="text" id="popcorn" name="popcorn" style="flex:1;">
                                <button class="button is-small is-light" id="validatePopcornBtn" type="button">Validate</button>
                            </div>
                            <div id="popcornPreview" style="display:none; position:relative;">
                                <div id="popcornPopover" style="display:none; position:absolute; left:0; bottom:2.5em; top:auto; background:#fff; border:1px solid #ccc; box-shadow:0 2px 8px #ddd; padding:0.5em 1em; border-radius:6px; z-index:10; min-width:220px;">
                                    <span class="has-text-grey">Preview Popcorn Link:</span>
                                    <a id="popcornLinkPreview" class="has-text-link" href="#" target="_blank"></a>
                                </div>
                            </div>
                        </div>
                        <div class="field">
                            <div class="control">
                                <button class="button is-link" type="submit" id="generateBtn">
                                    Make
                                    &nbsp;<span id="saleTypePlaceholder">Coffee</span>&nbsp;
                                    Link &amp; Flyer</button>
                            </div>
                        </div>
                    </form>
                    <!-- add a dynamic (scroll down) message after generation-->
                    <p class="has-text-centered" id="scrollDownMessage" style="display:none;">(Scroll down for your fundraiser link and flyer)</p>
                </div>
            </section>
            <section id="socialSection" class="section" style="display:none;">
                <div class='box' style='margin:auto;'>
                    <h2 class='title is-5 has-text-centered'>Share Your Fundraiser</h2>
                    <p class='has-text-centered'>Copy and Paste this message:</p>
                    <div class='has-text-centered' style='margin-bottom:1em;'>
                        <textarea id='socialMsg' class='textarea' readonly style='margin-bottom:0.5em; min-height:220px;'></textarea>
                        <button class='button is-info' id='copyMsgBtn' title='Copy the message to your clipboard'>Copy
                            Message</button>
                        <div id="socialMsgTemplate" style="display:none;">
                            Support [Scout Name]'s fundraising for {{ site.scout_type }} {{ site.unit_type }} {{
                            site.unit_number }}! Order delicious coffee and treats! [URL]
                        </div>
                    </div>
                    <p class='has-text-centered'>Or share this direct link: <a id='socialLink' class='has-text-link'
                            href='#' target='_blank'></a></p>
                </div>
            </section>
        </div>
        <!-- Print Flyer Section -->
        <div id="flyerSection" style="display:none; margin-top:2em;">
            <div class="box" style="margin:auto;">
                <div class="has-text-centered no-print" style="margin-bottom:1em;">
                    <button class="button is-primary" onclick="window.print()" title="Print a flyer to hand out">Print
                        Your Fundraiser Flyer</button>
                </div>
                <h2 id="flyerTitle" class="title is-4 has-text-centered no-print">Your Printable Fundraiser Flyer</h2>
                <div class="has-text-centered" style="margin-bottom:0.5em;">
                    <img id="flyerImg" src="/assets/images/coffee.png" alt="Coffee Fundraiser" style="display:inline-block;">
                </div>
                <p class="has-text-centered title" id="flyerFundraiserText" style="font-size:1.2em; font-weight:bold; margin-bottom:0.5em;">
                    {{ site.scout_type }} {{ site.unit_type }} {{ site.unit_number }} Coffee Fundraiser
                </p>
                <p class="has-text-centered" style="margin-bottom:0.5em;">
                    Support <strong><span id="flyerScout"></span></strong> in their Scouting journey! <br/> Your order of delicious coffee or treats helps them reach their goal.
                </p>
                <div class="has-text-centered" style="margin-bottom:1em; position:relative; width:340px; height:340px; margin:auto;">
                    <!-- CSS Sunburst Callouts -->
                    <div class="sunburst" style="left:-170px; top:-170px; --burst-color:#ff3860; --angle:-15deg;">
                        <span>ORDER ONLINE</span>
                    </div>
                    <div class="sunburst" style="right:-160px; top:140px; --burst-color:#3273dc; --angle:15deg;">
                        <span>SHIPS DIRECTLY</span>
                    </div>
                    <div class="sunburst" style="left:70%; bottom:-170px; transform:translate(-50%, 10px); --burst-color:#23d160; --angle:-10deg;">
                        <span>ARRIVES SOONER</span>
                    </div>
                    <!-- QR Code Center -->
                    <div class="flyer-qr-area">
                        <canvas id="flyerQR" style="margin:auto;"></canvas>
                    </div>
                </div>
                <p class="has-text-centered">Scan the QR code or visit this link:</p>
                <p class="has-text-centered"><a id="flyerLink" class="has-text-link" href="#" target="_blank"></a></p>
            </div>
        </div>
        </div>
    </section>
    <script src="https://cdn.jsdelivr.net/npm/qrious/dist/qrious.min.js"></script>
        <script>
        // Simple SHA-256 hash, returns first 8 hex chars
        async function scoutHash(str) {
            const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(str));
            return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2, '0')).join('').slice(0,8);
        }
        // Popcorn code preview popover and button text/color change
        const popcornInput = document.getElementById('popcorn');
        const previewDiv = document.getElementById('popcornPreview');
        const previewLink = document.getElementById('popcornLinkPreview');
        const btn = document.getElementById('generateBtn');
        const validateBtn = document.getElementById('validatePopcornBtn');
        const popover = document.getElementById('popcornPopover');

        popcornInput.addEventListener('input', function () {
            const code = this.value.trim();
            let saleTypePlaceholder = document.getElementById('saleTypePlaceholder');
            let saleType;
            validateBtn.disabled = !code;
            if (code) {
                saleType = 'Coffee &amp; Popcorn';
                btn.classList.remove('is-link');
                btn.classList.add('is-warning');
            } else {
                saleType = 'Coffee';
                btn.classList.remove('is-warning');
                btn.classList.add('is-link');
                previewDiv.style.display = 'none';
                popover.style.display = 'none';
            }
            saleTypePlaceholder.innerHTML = saleType;
        });

        validateBtn.addEventListener('click', function () {
            const code = popcornInput.value.trim();
            if (code) {
                previewDiv.style.display = 'block';
                if (popover.style.display === 'block') {
                    popover.style.display = 'none';
                } else {
                    popover.style.display = 'block';
                    previewLink.href = `{{site.popcorn_base_link}}${encodeURIComponent(code)}`;
                    previewLink.textContent = previewLink.href;
                }
            } else {
                previewDiv.style.display = 'none';
                popover.style.display = 'none';
                previewLink.href = '#';
                previewLink.textContent = '';
            }
        });

        // Hide popover when clicking outside
        document.addEventListener('click', function (e) {
            if (!popover.contains(e.target) && e.target !== validateBtn) {
                popover.style.display = 'none';
            }
        });


        document.getElementById('linkForm').onsubmit = function (e) {
                e.preventDefault();
                let scoutRaw = document.getElementById('scout').value.trim();
                let scout = encodeURIComponent(scoutRaw).replace(/%20/g, '+');
                let popcornRaw = document.getElementById('popcorn').value.trim();
                let popcorn = encodeURIComponent(popcornRaw).replace(/%20/g, '+');
                if (!scout) {
                    alert('Scout name is required.');
                    return;
                }
                scoutHash(scoutRaw).then(t => {
                    const isPopcorn = Boolean(popcorn);
                    const url = isPopcorn
                        ? `${window.location.origin}/sell/?scout=${scout}&popcorn=${popcorn}&t=${t}`
                        : `${window.location.origin}/coffee/?scout=${scout}&t=${t}`;
                    const flyerKind = isPopcorn ? 'Coffee & Popcorn Fundraiser' : 'Coffee Fundraiser';
                    const flyerTitle = flyerKind + ' Flyer';
                    const flyerFundraiserText = `{{ site.scout_type }} {{ site.unit_type }} {{ site.unit_number }} ${flyerKind}`;
                    const flyerImgSrc = isPopcorn ? '/assets/images/sell.png' : '/assets/images/coffee.png';
                    // Populate and show social media share section
                    const socialSection = document.getElementById('socialSection');
                    const socialMsg = document.getElementById('socialMsg');
                    const socialLink = document.getElementById('socialLink');
                    const template = document.getElementById('socialMsgTemplate').textContent.trim();
                    const scoutName = decodeURIComponent(scout.replace(/\+/g, ' '));
                    const message = template.replace('[Scout Name]', scoutName).replace('[URL]', url);
                    socialMsg.value = message;
                    socialLink.href = url;
                    socialLink.textContent = url;
                    socialSection.style.display = '';
                    document.getElementById('copyMsgBtn').onclick = function () {
                        navigator.clipboard.writeText(socialMsg.value);
                    };
                    // Show flyer section and print button, and populate flyer
                    const flyerSection = document.getElementById('flyerSection');
                    flyerSection.style.display = '';
                    document.getElementById('flyerScout').textContent = scoutRaw;
                    document.getElementById('flyerLink').href = url;
                    document.getElementById('flyerLink').textContent = url;
                    document.getElementById('flyerTitle').textContent = flyerTitle;
                    document.getElementById('flyerFundraiserText').textContent = flyerFundraiserText;
                    document.getElementById('flyerImg').src = flyerImgSrc;
                    // Generate QR for flyer
                    new QRious({ element: document.getElementById('flyerQR'), value: url, size: 200 });
                    // Show scroll down message
                    document.getElementById('scrollDownMessage').style.display = '';
                });
        };
    </script>
    {% include google_analytics.html %}

</body>

</html>